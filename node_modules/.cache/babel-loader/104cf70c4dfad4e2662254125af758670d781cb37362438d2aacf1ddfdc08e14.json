{"ast":null,"code":"var http = require('http'),\n  querystring = require('querystring'),\n  url = require('url');\n\n//  Ebay Service Endpoints\nvar SERVICE_URLS = {\n  finding: 'http://svcs.ebay.com/services/search/FindingService/v1'\n};\nvar SERVICES = {};\n//  parse Service Endpoints\nObject.keys(SERVICE_URLS).forEach(function (key) {\n  SERVICES[key] = url.parse(SERVICE_URLS[key]);\n});\n\n//  Allowed http verbs\nvar VERBS = ['get', 'post'];\nmodule.exports = Ebay;\nfunction Ebay(opts) {\n  if (!opts || !opts.app_id) {\n    throw new Error('options object must specify `app_id`');\n  }\n  this.opts = opts;\n}\nEbay.prototype.makeRequest = function (verb, service, params, cb) {\n  if (!cb || typeof cb !== 'function') throw new Error('must provide callback');\n  if (!params || typeof params !== 'object') {\n    var err = new Error('must specify params object');\n    return cb(err, null);\n  }\n  if (VERBS.indexOf(verb) === -1) {\n    var err = new Error('http verb `' + verb + '` not allowed');\n    return cb(err, null);\n  }\n  var svc = SERVICES[service];\n  if (!svc) {\n    var err = new Error('Ebay service `' + service + '` not supported');\n    return cb(err, null);\n  }\n  params['SECURITY-APPNAME'] = this.opts.app_id;\n  params['SERVICE-VERSION'] = '1.0.0';\n  params['RESPONSE-DATA-FORMAT'] = 'JSON';\n  params['REST-PAYLOAD'] = true;\n  var qs = querystring.stringify(params);\n  var opts = {\n    host: svc.host,\n    path: svc.path + '?' + qs,\n    method: verb.toUpperCase()\n  };\n  var req = http.request(opts, function (res) {\n    var data = '';\n    res.on('data', function (chunk) {\n      data += chunk;\n    });\n    res.on('end', function () {\n      var error = null,\n        parsed = null;\n      try {\n        parsed = JSON.parse(data);\n      } catch (err) {\n        error = new Error('Ebay reply is not valid JSON');\n        error.msg = err;\n      } finally {\n        return cb(error, parsed);\n      }\n    });\n  });\n  req.on('error', function (err) {\n    var error = new Error('http client error');\n    error.msg = err;\n    return cb(error, null);\n  });\n  req.end();\n};\nVERBS.forEach(function (verb) {\n  Ebay.prototype[verb] = function (service, params, cb) {\n    return this.makeRequest(verb, service, params, cb);\n  };\n});","map":{"version":3,"names":["http","require","querystring","url","SERVICE_URLS","finding","SERVICES","Object","keys","forEach","key","parse","VERBS","module","exports","Ebay","opts","app_id","Error","prototype","makeRequest","verb","service","params","cb","err","indexOf","svc","qs","stringify","host","path","method","toUpperCase","req","request","res","data","on","chunk","error","parsed","JSON","msg","end"],"sources":["/Users/Tian/Documents/blink2/node_modules/ebay/ebay.js"],"sourcesContent":["var http = require('http')\n  , querystring = require('querystring')\n  , url = require('url')\n\n//  Ebay Service Endpoints\nvar SERVICE_URLS = {\n  finding: 'http://svcs.ebay.com/services/search/FindingService/v1'\n}\n\nvar SERVICES = {}\n//  parse Service Endpoints\nObject.keys(SERVICE_URLS).forEach(function (key) {\n  SERVICES[key] = url.parse(SERVICE_URLS[key])\n})\n\n//  Allowed http verbs\nvar VERBS = ['get', 'post']\n\nmodule.exports = Ebay\n\nfunction Ebay (opts) {\n  if(!opts || !opts.app_id) {\n    throw new Error('options object must specify `app_id`')\n  }\n  this.opts = opts\n}\n\nEbay.prototype.makeRequest = function (verb, service, params, cb) {\n  if(!cb || typeof cb !== 'function')       throw new Error('must provide callback')\n  if(!params || typeof params !== 'object') {\n    var err = new Error('must specify params object')\n    return cb(err, null)\n  }\n  if(VERBS.indexOf(verb) === -1) {\n    var err = new Error('http verb `' + verb + '` not allowed')\n    return cb(err, null)\n  }\n  var svc = SERVICES[service]\n  if(!svc) {\n    var err = new Error('Ebay service `' + service + '` not supported')\n    return cb(err, null)\n  }\n\n  params['SECURITY-APPNAME'] = this.opts.app_id\n  params['SERVICE-VERSION'] = '1.0.0'\n  params['RESPONSE-DATA-FORMAT'] = 'JSON'\n  params['REST-PAYLOAD'] = true\n\n  var qs = querystring.stringify(params)\n\n  var opts = {\n    host: svc.host\n  , path: svc.path + '?' + qs\n  , method: verb.toUpperCase()\n  }\n\n  var req = http.request(opts, function (res) {\n    var data = ''\n    res.on('data', function (chunk) { data += chunk })\n    res.on('end', function () {\n      var error = null\n        , parsed = null\n\n      try {\n        parsed = JSON.parse(data)\n      } catch (err) {\n        error = new Error('Ebay reply is not valid JSON')\n        error.msg = err\n      } finally {\n        return cb(error, parsed)\n      }\n    })\n  })\n  req.on('error', function (err) {\n    var error = new Error('http client error')\n    error.msg = err\n    return cb(error, null)\n  })\n  req.end()\n}\n\nVERBS.forEach(function (verb) {\n  Ebay.prototype[verb] = function (service, params, cb) {\n    return this.makeRequest(verb, service, params, cb)\n  }\n})"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}